<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8" />
  <!-- multi-device width -->
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <!-- site description -->
  
  <meta content="" name="description" />
  <!-- referer for 3rd-part images-->
  <meta content="no-referrer" name="referrer" />
  <!-- title -->
  <title>
    
    An Encrypt and Dectrypt tool with sjcl.js
    
  </title>
  <!-- icon -->
  <link href="https://multipli.city/assets/img/favicon.ico?" rel="shortcut icon bookmark" type="image/x-icon" />
  <!-- main stylesheet -->
  <link rel="stylesheet" href="https://multipli.city/assets/css/main.css" type="text/css" />
  <!-- fa 5.9.0 -->
  <link rel="stylesheet" href="https://multipli.city/assets/css/fa.min.css" type="text/css" />
  <!-- rouge theme-->
  <link rel="stylesheet" href="https://multipli.city/assets/css/rouge-bg.css" />

  

  

  <!-- mathjax 2.7.5 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
  </head>

  <body class="page">
    <!-- background animations -->
<div class="div_bg">
  <canvas id="c"></canvas>
</div>
<script>
  // var colors = [ "#faa", "#f12", "#f2a" ]
  var colors = [ "#ebbebe", "#b95775", "#be639b", "#a63333", "#7b3349" ]
  var fontSizeMults = [ 0.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.5, 2.0 ]
  var c = document.getElementById("c");
  var ctx = c.getContext("2d");
  c.height = window.innerHeight;
  c.width = window.innerWidth;
  var txts = "▲⟁◮◬▷▷△◁⧍⧋⧊⨹∧∨⨺⧌⛛◀▶▵⨻⨻⨻";
  txts = txts.split("");
  var font_size = 2;
  var columns = c.width / font_size;
  var drops = [];
  for (var x = 0; x < columns; x++) drops[x] = 1;

  function draw() {
    ctx.fillStyle = "rgba(0, 0, 0, 0.01)";
    ctx.fillRect(0, 0, c.width, c.height);
    ctx.fillStyle = colors[Math.floor(Math.random() * colors.length)];// "#faa";
    font_size = font_size * fontSizeMults[Math.floor(Math.random() * fontSizeMults.length)];
    ctx.font = font_size + "px arial";
    for (var i = 0; i < drops.length; i++) {
      var text = txts[Math.floor(Math.random() * txts.length)];
      ctx.fillText(text, i * font_size, drops[i] * font_size);
      if (drops[i] * font_size > c.height || Math.random() > 0.98) drops[i] = 0;
      drops[i]++;
    }
  }
  setInterval(draw, 9000);
</script>

    <div class="container" id="ctner">
      <div class="header">
    <nav class="nav_bar">
        <ul>
            <!-- left header -->
            <li
                class="li_left">
                <!-- home -->
                
                    <a class="header_btn" href="https://multipli.city">
                        <i class="fa fa-home">
                            
                                <p class="btn_text">Home</p>
                            
                        </i>
                    </a>
                
                <a class="header_btn" href="//s3.amazonaws.com/sonicmultiplicities.audio/feed/feed.xml">
                  <i class="fa fa-podcast" aria-hidden="true">
                    <p class="btn_text">Podcast</p>
                  </i>
                </a>
                <!-- email -->
                
                    <a class="header_btn" href="mailto:andrew@multipli.city">
                        <i class="fa fa-envelope-square">
                            
                                <p class="btn_text">Email</p>
                            
                        </i>
                    </a>
                
                <!-- github -->
                
                    <a class="header_btn" href="https://github.com/sacreddata">
                        <i class="fa fa-github">
                            
                                <p class="btn_text">Github</p>
                            
                        </i>
                    </a>
                
                <!-- maximize -->
                
                    <a class="header_btn" id="mxmz_btn" onclick="toggle_maximize()">
                        <i class="fa fa-window-maximize">
                            
                                <p class="btn_text" id="mxmz_text">Maximize</p>
                            
                        </i>
                    </a>
                
                <!-- access token -->
                
            </li>
            <!-- right header -->
            <span
                class="span_right">
                <!-- popup table of content -->
                
                    <a class="header_btn" onclick="scroll_percentage(-0.88)">
                        <i class="fa fa-backward">
                            
                                <p class="btn_text">Prev</p>
                            
                        </i>
                    </a>
                    <!-- scroll down -->
                    <a class="header_btn" onclick="scroll_percentage(0.88)">
                        <i class="fa fa-forward">
                            
                                <p class="btn_text">Next</p>
                            
                        </i>
                    </a>
                    <!-- popup table of content -->
                    <a class="header_btn popup_btn" onclick="toggle_toc()">
                        <i class="fa fa-bars">
                            
                                <p class="btn_text">Content</p>
                            
                        </i>
                    </a>
                
            </span>
        </ul>
    </nav>
    <hr/>
</div>
<!-- table of content -->

    <div class="div_toc toc" id="popup_toc">
    
    <!-- generate toc -->
    
    </div>
    <!-- toggle toc -->
    <script>
    function toggle_toc() {
        var popup = document.getElementById("popup_toc");
        popup.classList.toggle("show");
    }
    </script>
    <!-- scroll page -->
        <script>
    function scroll_percentage(mtpler) {
        document
        .getElementById("div_atcl")
        .scrollBy(0, window.innerHeight * mtpler);
    }
    </script>

<!-- toggle maximize -->

<script>
  var ctner_state = 0;
  var ctner = document.getElementById("ctner");
  function toggle_maximize() {
    if (ctner_state == 0) {
      ctner.style.width = "100%";
      ctner.style.height = "100%";
      ctner.style.top = "0";
      ctner.style.maxWidth = "100%";
      if (document.getElementById("mxmz_text")) {
        document.getElementById("mxmz_text").innerHTML = "Restore";
      }
      ctner_state = 1;
    } else if (ctner_state == 1) {
      ctner.style.width = "84%";
      ctner.style.height = "97%";
      ctner.style.top = "2%";
      ctner.style.maxWidth = "1240px";
      if (document.getElementById("mxmz_text")) {
        document.getElementById("mxmz_text").innerHTML = "Maximize";
      }
      ctner_state = 0;
    }
  }
</script>

<!-- encrypt and decrypt -->


      <div class="div_article" id="div_atcl">       
        <article id="main_atcl" itemscope itemtype="http://schema.org/BlogPosting">
          
<h1>
  An Encrypt and Dectrypt tool with sjcl.js
</h1>

<div class="post_info">
  <!-- author -->
  
  <span>
    <i class="fa fa-user-secret"></i>
    <a href='https://multipli.city/DeerRIDER'>DeerRIDER</a>, 
  </span>
  
  <!-- date -->
  
  <span>
    <i class="fa fa-calendar"></i>
    Apr 16, 2019
  </span>
  
  <!-- category -->
  
  <span>
    <i class="fa fa-archive"></i>
    Sample
  </span>
  
</div>
<!-- abstract -->
<div class="abstract">
  
</div>

<div id="downloads">
  <b>Download:</b>
  <a href="" id="flac_download">FLAC</a>
  <a href="" id="opus_download">OPUS</a>
  <a href="" id="mp3_download">MP3</a><br><br>
</div>
<script>
  var sm = "".split('/')[3].replace('.mp3','');
  var mp3Url = `//s3.amazonaws.com/sonicmultiplicities.audio/feed/${sm}.mp3`;
  var flacUrl = `//s3.amazonaws.com/sonicmultiplicities.audio/feed/downloads/${sm}.flac`;
  var opusUrl = `//s3.amazonaws.com/sonicmultiplicities.audio/feed/downloads/${sm}.opus`;

  document.getElementById("flac_download").href = flacUrl;
  document.getElementById("opus_download").href = opusUrl;
  document.getElementById("mp3_download").href = mp3Url;

</script>


<script src="https://multipli.city/assets/js/vibrant.js"></script>
<div id="player_msg"><i class="fa fa-cog fa-spin fa-3x fa-fw"></i> LOADING SONICS</div>
<div id="player"></div>
<div id="player_controls">
  <div id="music_dur"></div>
  <button id="audioBtnPlay" onclick="wavesurfer.play()">
    <i class="fa fa-play" aria-hidden="true"></i>
  </button>
  <button id="audioBtnPause" onclick="wavesurfer.pause()">
    <i class="fa fa-pause" aria-hidden="true"></i>
  </button>
  <button id="toggleMuteBtn" onclick="wavesurfer.toggleMute()">Toggle Mute</button>
  
  <input id="volume" type="range" min="0" max="1" value="1" step="0.1" style="float:right">
</div>
 <script>
   var cover = ""
   var url = ""

   
   var dur = 0.0;

   var v = new Vibrant("https:" + cover);

   var wavesurfer = WaveSurfer.create({
     container: "#player",
     cursorWidth: 2,
   });

   // var audioCtx = new(window.AudioContext || window.webkitAudioContext)();
   var audioCtx = wavesurfer.backend.ac;
   var analyser = audioCtx.createAnalyser();

   analyser.fftSize = 2048;

   var bufferLength = analyser.frequencyBinCount;
   var dataArray = new Uint8Array(bufferLength);
   analyser.getByteTimeDomainData(dataArray);

	// var canvas = document.getElementById("oscilloscope");
	var canvas = document.getElementById("c");

	var canvasCtx = canvas.getContext("2d");

  // Add event listener for `click` events.
   canvas.addEventListener('click', function(event) {
     var x2 = event.pageX,
         y2 = event.pageY;
     console.log(x2, y2);
     if (animationId) {
       cancelAnimationFrame(animationId)
       animationId = undefined;
     } else {
       draw()
     }
   })
  
  function shuffle(a) {
      for (let i = a.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
  }

  var lineWidth = 2;
  var drawColors = shuffle(colors)
  var widthDelta = 0;
  var alpha = 1.0;
  var animationId = '';
  console.log(drawColors)

	// draw an oscilloscope of the current audio source

	function draw() {

		animationId = requestAnimationFrame(draw);

		analyser.getByteTimeDomainData(dataArray);

    
    canvasCtx.fillStyle = `rgb(0, 0, 0, ${alpha})`;
		canvasCtx.fillRect(0, 0, canvas.width, canvas.height);
    
		canvasCtx.lineWidth = lineWidth;
    canvasCtx.strokeStyle = drawColors[0];
		// canvasCtx.strokeStyle = "rgb(200, 200, 200)";

		canvasCtx.beginPath();

		var sliceWidth = canvas.width * 1.0 / bufferLength;
		var x = 0;

		for (var i = 0; i < bufferLength; i++) {

			var v = dataArray[i] / 128.0;
			var y = v * canvas.height / 2;

			if (i === 0) {
				canvasCtx.moveTo(x, y);
        if (lineWidth > 5) {
          drawColors = shuffle(drawColors)
        }
			} else {
				canvasCtx.lineTo(x, y);

        if (y < (canvas.height / 28) || y > (canvas.height * (28/32))) {
          drawColors = shuffle(drawColors)
        }

        widthDelta = shuffle([0.001, -0.0001, -1, 0.27, 0.02, 0.1, 0.0000001, 0.00001, -0.000001, -0.000001])[0];
        if (lineWidth > 0) {
          lineWidth += widthDelta
        } else {
          lineWidth = 2;
          alpha += shuffle([-0.1, 0.1, 1.0])[0];
        }
			}

			x += sliceWidth;
		}

    if (lineWidth > 100.0) {
      lineWidth = 1.0;
      alpha = shuffle([0.5, 0.005, 0.0008])[2];
    }

    if (alpha > 1) {
      alpha = shuffle([0.1, 0.001, 0.0001])[0];
    } 

		canvasCtx.lineTo(canvas.width, canvas.height / 2);
		canvasCtx.stroke();
	}


	 wavesurfer.setVolume(0.4);
	 document.querySelector('#volume').value = wavesurfer.backend.getVolume();

    var volumeInput = document.querySelector('#volume');
    var onChangeVolume = function (e) {
      wavesurfer.setVolume(e.target.value);
      console.log(e.target.value);
    };
		volumeInput.addEventListener('input', onChangeVolume);
		volumeInput.addEventListener('change', onChangeVolume);


   wavesurfer.backend.setFilter(analyser);

   wavesurfer.on('finish', () => {
     if (animationId) {
       cancelAnimationFrame(animationId)
       animationId = undefined
     }
   })

   wavesurfer.on('ready', function () {
         document.getElementById("player_msg").innerHTML = "";
         draw();
         wavesurfer.play();
         dur = wavesurfer.getDuration().toFixed(2);
         document.getElementById("music_dur").innerHTML = `<i class="fa fa-clock-o" aria-hidden="true"></i> ${dur}`;
   });

   wavesurfer.load(`//${url}`);
   v.getPalette((err, palette) => {
     if (err) {
       console.log(err)
     }

     var muted = !err ? palette.Muted ? palette.Muted.getHex() : null : null;
     var vibrant = !err ? palette.Vibrant ? palette.Vibrant.getHex() : null : null;
     var darkVibrant = !err ? palette.DarkVibrant ? palette.DarkVibrant.getHex() : null : null;

     wavesurfer.setWaveColor(vibrant || "#999");
     wavesurfer.setProgressColor(muted || "#555");
     wavesurfer.setCursorColor(darkVibrant || "#333");

     colors.push(darkVibrant, vibrant, muted);
   })

   wavesurfer.on('seek', () => {
     alpha = 0.0001;
   })

   function toggleBin() {
     var stUrl = "";
     var binUrl = "";
     url = url == stUrl ? binUrl : stUrl
     wavesurfer.load(`//${url}`);
   }

 </script>
 



<!-- aes encrypt and decrypt method -->
<script
  src="https://multipli.city/assets/js/sjcl.js"
  async
></script>

<div class="div_token">
  <table>
    <thead>
      <th colspan="3">
        Password is required in both encryption and decryption
      </th>
    </thead>
    <tbody>
      <tr>
        <td>Password</td>
        <td>
          <textarea
            class="access_token"
            rows="1"
            cols="50"
            id="pwd"
            style="resize: vertical;"
          ></textarea>
        </td>
        <td></td>
      </tr>
      <tr>
        <td>
          Message
        </td>
        <td>
          <textarea
            class="access_token"
            rows="5"
            cols="50"
            id="msg"
            style="resize: vertical;"
          ></textarea>
        </td>
        <td><button class="encrypt" onclick="encrypt()">Encrypt</button></td>
      </tr>
      <tr>
        <td>Ciphertext</td>
        <td>
          <textarea
            class="access_token"
            rows="5"
            cols="50"
            id="ct"
            style="resize: vertical;"
          ></textarea>
        </td>
        <td><button class="encrypt" onclick="decrypt()">Decrypt</button></td>
      </tr>
      <tr>
        <td>Minimized</td>
        <td>
          <textarea
            class="access_token"
            rows="5"
            cols="50"
            id="min_text"
            style="resize: vertical;"
          ></textarea>
        </td>
        <td></td>
      </tr>
    </tbody>
  </table>
</div>
<script>
  function encrypt() {
    var pwd = document.getElementById("pwd").value;
    var msg = document.getElementById("msg").value;
    var ct =  sjcl.json.encrypt(pwd, msg,{salt: ""});
    var ct_obj = JSON.parse(ct);
    document.getElementById("ct").value = ct;
    document.getElementById("msg").value = "";
    document.getElementById("min_text").value = (ct_obj.iv.substring(0,22) + ct_obj.ct);
  }
  function decrypt() {
    var pwd = document.getElementById("pwd").value;
    var ct = document.getElementById("ct").value;
    document.getElementById("msg").value = sjcl.json.decrypt(pwd, ct);
    document.getElementById("ct").value = "";
    document.getElementById("min_text").value = "";
  }
</script>


          

        </article>
          
      </div>
    </div>
  </body>
</html>
